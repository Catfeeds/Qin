{extend name="public:ModelBase" /}
{block name="title"}报名信息{/block}
{block name="right"}

    <div class="layui-tab layui-tab-brief" lay-filter="user">

      <ul class="layui-tab-title" id="LAY_mine">
		<li data-type="mine-jie" lay-id="index"><a href="{:url('usercontrol/index_player_school')}">本校报名信息</a></li>
        <li data-type="mine-jie" lay-id="index" class="layui-this">报名信息</li>
      </ul>
          <form class="layui-form layui-form-pane"  style="padding: 20px 0;" action="" method="post" id="fid" enctype="multipart/form-data">
			<div class="layui-form-item">
				<label class="layui-form-label">填报分类</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="type" placeholder="请输入名称"  value="{$obj.type_name}{if ($obj.maxid neq 0)}-{$obj.maxname}{/if}{if ($obj.minid neq 0)}-{$obj.minname}{/if}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">姓    名</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="user_name" placeholder="请输入名称"  value="{$obj.user_name}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">性    别</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="user_sex" placeholder="请输入年龄" value="{$obj.user_sex}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">年    龄</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="user_age" placeholder="请输入年龄" value="{$obj.user_age}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">民    族</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="race" placeholder="请输入民族"  value="{$obj.race}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  
			   <div class="layui-form-item">
				<label class="layui-form-label">出生日期</label>
				<div class="layui-input-block">
				<div class="layui-input-inline">
				  <input class="layui-input" name="user_birth" placeholder="选择时间" value="{$obj.user_birth|date='Y-m-d',###}">
				  </div>
				  <div class="layui-form-mid layui-word-aux">如:2017-07-07</div>
				</div>
			  </div>
			  <div class="layui-form-item" pane>
				<label class="layui-form-label">照    片</label>
				<div class="layui-input-block">
					<img style="width:200px" src="{$obj.img}"/>
				</div>
			  </div>
			  <div class="layui-form-item" >
				<label class="layui-form-label">所属状态</label>
				<div class="layui-input-block">
					<input type="text" Readonly name="back_4" placeholder="请输入状态"  value="{if ($obj.back_4==1&&$obj.sid==0)}社会{else/}在校{/if}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">所属地区</label>
				<div class="layui-input-block">
					<input type="text" Readonly name="pname" placeholder="请输入地区"  value="{$obj.pname}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  {if ($obj.back_4==1)}
			  <div class="layui-form-item">
				<label class="layui-form-label">所属详细</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="school_name" placeholder="请输入工作单位 或 学校院系"  value="{$obj.sname}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">所属详细</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="unit" placeholder="请输入工作单位 或 学校院系"  value="{$obj.unit}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  {else /}
			  <div class="layui-form-item">
				<label class="layui-form-label">所属详细</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="school_name" placeholder="请输入工作单位 或 学校院系"  value="{if ($obj.ssid==0)}{$obj.unit}{else/}$obj.ssname{/if}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  {/if}
			  <div class="layui-form-item">
				<label class="layui-form-label">通讯地址</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="site" placeholder="请输入通讯地址"  value="{$obj.site}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			 
			  <div class="layui-form-item">
				<label class="layui-form-label">手机号码</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="tel" placeholder="请输入手机号码"  value="{$obj.tel}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">指导老师</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="teacher" placeholder="请输入指导老师"  value="{$obj.teacher}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">邮政编码</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="postcode" placeholder="请输入邮政编码"  value="{$obj.postcode}" required lay-verify="required" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item layui-form-text" id="tt1" style="{if $obj.type==28}display:none;{else/}display:block;{/if}" >
				<label class="layui-form-label">{if condition="$obj.type==1"}参赛人员{elseif condition="$obj.type==27"/}主创人员简介{else/}选手简介{/if}</label>
				<div class="layui-input-block">
				  <textarea name="esc" placeholder="请输入{if condition="$obj.type==1"}参赛人数及姓名{elseif condition="$obj.type==27"/}主创人员简介{else/}选手简介{/if}" class="layui-textarea"  value="{$obj.esc}" Readonly>{$obj.esc}</textarea>
				</div>
			  </div>
			   <div class="layui-form-item" id="tt2">
				<label class="layui-form-label">{if condition="$obj.type==1"}节目名称{elseif condition="$obj.type==27"/}电影名{elseif condition="$obj.type==28"/}动漫创意作品名称{else/}作品名称{/if}</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="wname" placeholder="请输入{if condition="$obj.type==1"}节目名称{elseif condition="$obj.type==27"/}电影名{elseif condition="$obj.type==28"/}动漫创意作品名称{else/}作品名称{/if}"  value="{$obj.wname}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item layui-form-text" id="tt3" style="{if condition="$obj.type==22"}display:none;{else/}display:block;{/if}" >
				<label class="layui-form-label">{if condition="$obj.type==1"}节目简介{elseif condition="$obj.type==27"/}剧本简介{elseif condition="$obj.type==31"/}作品简介及创作思路{else/}作品简介{/if}</label>
				<div class="layui-input-block">
				  <textarea name="intro" placeholder="请输入{if condition="$obj.type==1"}节目简介{elseif condition="$obj.type==27"/}剧本简介{elseif condition="$obj.type==31"/}作品简介及创作思路{else/}作品简介{/if}" class="layui-textarea"  value="{$obj.intro}" Readonly>{$obj.intro}</textarea>
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">推荐单位</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="rec" placeholder="请输入作品名称"  value="{$obj.rec}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item">
				<label class="layui-form-label">推荐单位联系人及电话</label>
				<div class="layui-input-block">
				  <input type="text" Readonly name="rectel" placeholder="请输入联系人及电话"  value="{$obj.rectel}" autocomplete="off" class="layui-input">
				</div>
			  </div>
			  <div class="layui-form-item" pane>
				<label class="layui-form-label" >审     核</label>
				<div class="layui-input-block">
				  <input type="hidden" name="stch" id="stch" value="{$obj.status}"> 
				  <input type="checkbox" lay-text="yes|no" lay-filter="stch" value="1" name="switch" {if $obj.status eq 1}checked{/if} lay-skin="switch">
				</div>
			  </div>
			  <div class="layui-form-item layui-form-text" id="shyy" style="display:{if ($obj.status eq 1)}none{else /}block{/if};" >
				<label class="layui-form-label">未通过审核原因</label>
				<div class="layui-input-block">
				      <textarea name="back_1" placeholder="未通过审核原因" class="layui-textarea"  value="{$obj.back_1}" readonly>{$obj.back_1}</textarea>
				</div>
			  </div>
			  <div class="layui-form-item" pane style="display:{if ($obj.status eq 1)}block{else /}none{/if};">
				<label class="layui-form-label">比赛状态</label>
				<div class="layui-input-block">
				    <input type="radio" name="cc" value="1" title="已审核" {if ($obj.back_2 eq 1)}checked{elseif ($obj.back_2 neq 2) /}checked{/if}>
					<input type="radio" name="cc" value="2" title="已淘汰" {if ($obj.back_2 eq 2)}checked{/if}>
				</div>
			  </div>

              <div class="layui-form-item">
                <button class="layui-btn" key="set-mine" lay-filter="*" lay-submit>确认修改</button>
              </div>
            </form>
          </div>
          
  
    </div>
{/block}

{block name="js"}
<script>

function getfile(){
	return  $("input[type='file']").click();
}
window.URL = window.URL || window.webkitURL;
	function handleFiles(obj) {
		
			fileList = document.getElementById("id_img");
			var files = obj.files;
			img = new Image();
			if(window.URL){	
				img.src = window.URL.createObjectURL(files[0]); //创建一个object URL，并不是你的本地路径
				img.className = "lay-img";
				img.style="width:200px";
				img.onload = function(e) {
					window.URL.revokeObjectURL(this.src); //图片加载后，释放object URL
				}
				if(fileList.firstElementChild){
					 fileList.removeChild(fileList.firstElementChild);
				} 
				fileList.appendChild(img);
			}else if(window.FileReader){
				//opera不支持createObjectURL/revokeObjectURL方法。我们用FileReader对象来处理
				var reader = new FileReader();
				reader.readAsDataURL(files[0]);
				reader.onload = function(e){	
						img.src = this.result;
						img.className = "lay-img";
						fileList.appendChild(img);
				}
			}else
			{
				//ie
				obj.select();
				obj.blur();
				var nfile = document.selection.createRange().text;
				document.selection.empty();
				img.src = nfile;
				img.className = "lay-img";
				img.onload=function(){
				  
				}
				fileList.appendChild(img);
			}
		
	}

layui.use('form', function(){
  var form = layui.form();

  //监听开关
  form.on('switch(stch)', function(data){
	
	if(data.elem.checked)
	{
		$("#stch").prop('value','1');
		$("#shyy").css('display','none');
		
	}else{
		$("#stch").prop('value','0');
		$("#shyy").css('display','block');
		
	}

  });  

  //监听提交
  form.on('submit(formDemo)', function(data){

	  if(data.field['stch']==0&&data.field['back_1']=='')
	  {
			layer.msg("请填写审核未通过原因");
			return false;		  
	  }

  });
});
</script>
{/block}


